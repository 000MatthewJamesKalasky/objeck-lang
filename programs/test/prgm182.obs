class Test {
	function : Main(args : String[]) ~ Nil {
		tape := "-3+2+-1";
		if(args->Size() = 1) {
			tape := args[0];
		};

		acum := 0; 
		oper := '\0';
		negate := false;
		each(i : tape) {
			char := GetChar(i, tape);			
			next_char := GetChar(i + 1, tape);

			if(char->IsDigit()) {
				value := (char - '0')->ToInt();
				select(oper) {
					label '+': {
						acum += value;
					}

					label '-': {
						acum -= value;
					}

					label '*': {
						acum *= value;
					}

					label '/': {
						acum /= value;
					}

					other  {
						acum += negate ? -value : value;
						negate := false;
					}
				};
				oper := '\0';
			}
			else if(<>negate) {
				select(char) {
					label '+':
					label '-':
					label '*':
					label '/': {
						if((char = '-' & i = 0) | next_char = '-') {
							negate := true;
						}
						else {
							oper := char;
							negate := false;
						};
					}
				};
			};
		};

		acum->PrintLine();
	}

	function : GetChar(i : Int, tape : String) ~ Char {
		if(i < tape->Size()) {
			return tape->Get(i);
		};

		return '\0';
	}
}
