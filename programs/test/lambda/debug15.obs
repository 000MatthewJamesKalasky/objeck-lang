class Test {
	function : Main(args : String[]) ~ Nil {
		f := DoInt(IntHolder) ~ IntHolder;
#		DoInt(IntHolder->New(3))->Get()->PrintLine();
#		f(IntHolder->New(3))->Get()->PrintLine();
#		HiYa( f(IntHolder->New(3))->Get() );
#		x := f(IntHolder->New(3));
#		x->Get()->PrintLine();

		
		h1 := FuncHolder->New(DoInt(IntHolder) ~ IntHolder)<IntHolder>;

		h2 := FuncHolder->New(\(IntHolder) ~ IntHolder : (i) => i * i)<IntHolder>;
		h3 := FuncHolder->New(DoString(String) ~ String)<String>;


		e1 := h2->Get()<IntHolder>;
		e1(IntHolder->New(4))->Get()->PrintLine();
		
	}

	function : DoInt(i : IntHolder) ~ IntHolder {
		return i * 3;
	}

	function : HiYa(i : Int) ~ Nil {
		i->PrintLine();
	}


	function : DoString(s : String) ~ String {
		s := String->New(s);
		s += " tacking on...";
		return s;
	}
}

class FuncHolder <T> {
	@func : (T) ~ T;

	New(func : (T) ~ T) {
		@func := func;
	}

	method : public : Get() ~ (T) ~ T {
		return @func;
	}

	method : public : Set(func : (T) ~ T) ~ Nil {
		@func := func;
	}
}