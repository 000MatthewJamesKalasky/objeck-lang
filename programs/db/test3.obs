use Collection.Generic;
use System.IO.File;

class Test {
	function : Main(args : String[]) ~ Nil {
		if(args->Size() = 1) {
			Test->New()->Process(args[0]);
		}
		else {
			"Invalid arguments!"->ErrorLine();
		};
	}

	New() {
	}

	method : public : Process(file : String) ~ Nil {
		table := Query.Structured.Table->FromCsv("Data", file);
		if(table <> Nil) {
			results := table->Query("from Data where Industry_code_NZSIOC = 'AA'");
			if(results <> Nil) {
				results->Size()->PrintLine();
			}
			else {
				"No results!"->ErrorLine();
			};
		};
	}
}