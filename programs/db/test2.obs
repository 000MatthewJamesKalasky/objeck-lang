use Collection.Generic;
use System.IO.File;
use Data.CSV;

class CsvData {
	function : Main(args : String[]) ~ Nil {
		if(args->Size() = 1) {
			table := Query.Structured.Table->FromCSV("sales", args[0]);
			if(table <> Nil) {
				result := table->Query("from sales 
					where ('Business Type' = 'New Logo' or 'Business Type' = 'New Division/Department') 
					and ('Product Name' like '%Coverity%' or 'Product Name' like '%Duck Pro%')");
				if(result <> Nil) {
					result->Count()->PrintLine();
				}
				else {
					"Invalid query?"->ErrorLine();
				};
			};
		}
		else {
			"Missing or too many arguments!"->ErrorLine();
		};
	}
}	