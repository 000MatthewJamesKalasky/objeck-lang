use SDL2;
use Game;

class Test {
	function : Main(args : String[]) ~ Nil {
		game := GameEngine->New(640, 480, "Engine Test");
		if(game->IsOk()) {
			e := game->GetEvent();
			
			image := game->AddImageSprite("../../../../programs/sdl/engine/tests/media/images/walker.png");

			x := 130;
			y := 70;
			offset := image->GetWidth() / 4;

			clip := Rect->New(0, 0, offset, image->GetHeight());
			w := 0;

			frame := 0;

			quit := false;
			while(<>quit) {
				game->FrameStart();

				while(e->Poll() <> 0) {
					if(e->GetType() = EventType->SDL_QUIT) {
						quit := true;
					};
				};

				clip->SetX(w);

				game->Clear();
				image->Render(x, y, clip);
				game->Show();

				game->FrameEnd();

				if(frame > 5) {
					w += offset;
					if(w > offset * 3) {
						w := 0;
					};
					frame := 0;
				};
				frame += 1;
			};
		};

		leaving {
			game->Quit();
		};
	}
}
