use Collection, API.Google.Gemini, System.IO.Filesystem;

class Test {
	function : Main(args : String[]) ~ Nil {
		key := EndPoint->GetApiKey();

		session := ChatSession->New("models/gemini-pro", key);

		candidate := session->AddPart(TextPart->New("What is the tallest mountain in the Colorado?"), "user");
		candidate->GetFirstPart()->ToString()->PrintLine();
		
		candidate := session->AddPart(TextPart->New("How tall is it?"), "user");
		candidate->GetFirstPart()->ToString()->PrintLine();

		candidate := session->AddPart(TextPart->New("Why is it so tall?"), "user");
		candidate->GetFirstPart()->ToString()->PrintLine();

		candidate := session->AddPart(TextPart->New("Where is it located?"), "user");
		candidate->GetFirstPart()->ToString()->PrintLine();
"======"->PrintLine();
		
		contents := session->GetParts()<Content>;
		each(content in contents) {
			content->ToString()->PrintLine();
		};
#~		
		models := Model->ListModels(key);
		each(model in models) {
			model->GetName()->PrintLine();
		};
		Model->GetModel("models/gemini-pro", key)->ToString()->PrintLine();
~#

#~
		content := Content->New("user")
			->AddPart(TextPart->New("What number is this image showing?"))
			->AddPart(BinaryPart->New(FileReader->ReadBinaryFile("thirdteen.png"), "image/png"));
		Model->CountTokens("models/gemini-pro-vision", content, key)->PrintLine();
~#

#~		
		candidates := Model->GenerateContent("models/gemini-pro-vision", content, key);
		each(candidate in candidates) {
			candidate->ToString()->PrintLine();
		};
~#		
	}
}