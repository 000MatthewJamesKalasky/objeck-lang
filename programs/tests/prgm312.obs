class Test {
	function : Main(args : System.String[]) ~ Nil {
		t := Trie->New();
		
#		t->Insert("hello")->PrintLine();
#		t->Insert("hella")->PrintLine();
		t->Insert("hey")->PrintLine();
		t->Insert("hi")->PrintLine();
		t->Insert("dog")->PrintLine();
#		t->Insert("heha")->PrintLine();

#		t->Has("hella")->PrintLine();
		t->Has("hey")->PrintLine();
		t->Has("he")->PrintLine();
#		t->Has("dog")->PrintLine();
#		t->Has("cat")->PrintLine();
#		t->Has("hella")->PrintLine();
	}
}

class Trie {
	@root : Node;

	New() {
		@root := Node->New();
	}

	method : public : Has(word : String) ~ Bool {
		match := Get(word);
		if(match <> Nil) {
			return match->IsTerminal();
		};

		return false;
	}

	method : Get(word : String) ~ Node {
		node := @root;

		each(char in word) {
			next := node->GetChild(char);
			if(next <> Nil) {
				node := next;
			}
			else {
				return Nil;
			}
		};

		return node;
	}

	method : public : Insert(word : String) ~ Int {
		node := @root;
		level := 0;
		
		each(char in word) {
			next := node->GetChild(char);
			if(next = Nil) {
				level += 1;
				node := node->SetChild(char, level);
			}
			else {
				node := next;
			};
		};

		if(node <> @root) {
			node->SetTerminal(word);
		};
		
		return level;
	}
}

class Node {
	@value : Char;
	@children : Node[];
	@level : Int;
	@word : String;

	New() {
		@value := '\0';
		@level := 0;

		@children := Node->New[0x100];
	}

	New(value : Char, level : Int) {
		@value := value;
		@level := level;

		@children := Node->New[0x100];
	}

	method : public : IsTerminal() ~ Bool {
		return @word <> Nil;
	}

	method : public : SetTerminal(word : String) ~ Nil {
		@word := word;
	}

	method : public : GetValue() ~ Char {
		return @value;
	}

	method : public : GetChildren() ~ Node[] {
		return @children;
	}

	method : public : GetChild(value : Char) ~ Node {
		return @children[value->ToInt()];
	}

	method : public : SetChild(value : Char, level : Int) ~ Node {
		node := Node->New(value, level);
		@children[value->ToInt()] := node;
		
		return node;
	}
}