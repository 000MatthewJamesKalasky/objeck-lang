class Test {
	function : Main(args : String[]) ~ Nil {
		time_str := Web.HTTP.HttpClient->QuickGet(Web.HTTP.Url->New("http://worldtimeapi.org/api/ip"))->ToString();
		if(time_str <> Nil) {
			root := Data.JSON.JsonParser->TextToElement(time_str);
			if(root <> Nil) {
				cur_time_elem := root->Get("datetime");
				if(cur_time_elem <> Nil) {
					cur_time := ParseTime(cur_time_elem->GetString(), false);
					if(cur_time <> Nil) {
						cur_time->ToString()->PrintLine();
					};
				};
			};
		};
	}

	function : ParseTime(str : String, is_gmt : Bool) ~ System.Time.Date {
		parts := str->Split('T');
		if(parts->Size() <> 2) {
			return Nil;
		};

		date := parts[0];
		date_parts := date->Split('-');
			
		year_str, month_str, day_str : String;
		if(date_parts->Size() <> 3) {
			return Nil;
		};
		year_str := date_parts[0];
		month_str := date_parts[1];
		day_str := date_parts[2];
		
		time := parts[1];		
		index := time->Find('.');
		if(index < 0) {
			return Nil;
		};
		time := time->SubString(index);

		time_parts := time->Split(':');
		if(time_parts->Size() <> 3) {
			return Nil;
		};

		hours := time_parts[0];
		minutes := time_parts[1];
		seconds := time_parts[2];

		return System.Time.DateUtility->Parse(
			"{$month_str}/{$day_str}/{$year_str} {$hours}:{$minutes}:{$seconds}", 
			"MM/dd/yyyy hh:mm:ss", is_gmt);
	}
}