use Collection;
use Data.JSON;
use Data.XML;
use Web.HTTP;

class Test {
	function : Main(args : String[]) ~ Nil {
#		CreateJson(); 
#		CreateXml();
		DownloadFile();	
#		CallCommand();
	}

	function : CreateJson() ~ Nil {
		builder := JsonBuilder->New();
		back := builder->PushObject();

		back->Insert("One", 1);
		back->Insert("Two", 2);
		back->Insert("Three", 3);

		builder->PopAll()->ToString()->PrintLine();
	}

	function : CreateXml() ~ Nil {
		builder := XmlBuilder->New("List");

		back := builder->GetRoot();

		back->AddChild(XmlElement->New(XmlElement->Type->ELEMENT, "One", "1"));
		back->AddChild(XmlElement->New(XmlElement->Type->ELEMENT, "Two", "2"));
		back->AddChild(XmlElement->New(XmlElement->Type->ELEMENT, "Three", "3"));

		back->ToString()->PrintLine();
	}

	function : DownloadFile() ~ Nil {
		client := HttpsClient->New();
		url := Url->New("https://news.ucdenver.edu/wp-content/uploads/2023/04/16x9-1536x865.jpg");
		data := client->Get(url, "image/jpeg");
data->Size()->PrintLine();		
		System.IO.Filesystem.FileWriter->WriteFile("a.jpg", data->ToByteArray());
	}

	function : CallCommand() ~ Nil {
		lines : String[];
		if(System.IO.Filesystem.Directory->GetSlash() = '/') {
			lines := Runtime->CommandOutput("ls");
		}
		else {
			lines := Runtime->CommandOutput("dir");
		};

		each(line := lines) {
			line->PrintLine();
		};
	}
}