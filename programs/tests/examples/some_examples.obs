use Collection;
use Data.JSON;
use Data.XML;
use Web.HTTP;

class Test {
	function : Main(args : String[]) ~ Nil {
		CreateJson();
		CreateXml();
		DownloadFile();
	}

	function : CreateJson() ~ Nil {
		builder := JsonBuilder->New();
		back := builder->PushObject();

		back->Insert("One", 1);
		back->Insert("Two", 2);
		back->Insert("Three", 3);

		builder->PopAll()->ToString()->PrintLine();
	}

	function : CreateXml() ~ Nil {
		builder := XmlBuilder->New("List");

		back := builder->GetRoot();

		back->AddChild(XmlElement->New(XmlElement->Type->ELEMENT, "One", "1"));
		back->AddChild(XmlElement->New(XmlElement->Type->ELEMENT, "Two", "2"));
		back->AddChild(XmlElement->New(XmlElement->Type->ELEMENT, "Three", "3"));

		back->ToString()->PrintLine();
	}

	function : DownloadFile() ~ Nil {
		urls := Collection.Vector->New()<Url>;
		urls->AddBack(Url->New("https://www.objeck.org/index.html"));

		headers := Collection.Map->New()<String,String>;

		downloads := WebDownloader->Download(urls, headers)<Pair<String, String>>;
		each(download := downloads) {
			download->GetSecond()->As(String)->PrintLine();
		};
	}
}