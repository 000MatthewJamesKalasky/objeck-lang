use Collection;

class Test {
	function : Main(args : String[]) ~ Nil {
		values := CompareVector->New()<IntRef>;
		each(i : 10) {
			values->AddBack(i);
		};
		"values set..."->PrintLine();

		filtered := Foo(values, Filter(IntRef) ~ Bool);
		each(value in filtered) {
			value->PrintLine();
		};
		"test 1..."->PrintLine();

		filtered := Bar(values, Filter(IntRef) ~ Bool);
		each(value in filtered) {
			value->PrintLine();
		};
		"test 2..."->PrintLine();

		filtered := values->Filter(Filter(IntRef) ~ Bool);
		each(value in filtered) {
			value->PrintLine();
		};
		"test 3..."->PrintLine();
	}

	function : Foo(values : CompareVector<IntRef>, func : (IntRef) ~ Bool) ~ CompareVector<IntRef> {
		filtered := CompareVector->New()<IntRef>;

		each(value in values) {
			result := func(value);
			if(result) {
				filtered->AddBack(value);
			};
		};

		return filtered;
	}

	function : Bar(values : CompareVector<IntRef>, func : (IntRef) ~ Bool) ~ CompareVector<IntRef> {
		filtered := CompareVector->New()<IntRef>;

		each(value in values) {
			if(func(value)) {
				filtered->AddBack(value);
			};
		};

		return filtered;
	}

	function : Filter(value : IntRef) ~ Bool {
		if(value->Get() < 4) {
			return true;
		};

		return false;
	}
}