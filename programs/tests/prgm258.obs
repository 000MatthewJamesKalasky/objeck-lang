class Test {
	function : Main(args : String[]) ~ Nil {
		matrix := [
			[51.0,  167.0]
			[62.0, 182.0]
			[69.0, 176.0]
			[64.0, 173.0]
			[65.0, 172.0]
			[56.0, 174.0]
			[58.0, 169.0]
			[57.0, 173.0]
			[55.0, 170.0]];
		test := [57.0, 170.0];
		k := 3;

		"--- Test ---"->PrintLine();
		test_str := test->ToString();
		"k={$k}, query={$test_str}"->PrintLine()
		
		"--- Data ---"->PrintLine();
		dims := matrix->Size();
		rows := dims[0];
		cols := dims[1];

		results := Collection.CompareVector->New()<FloatRef>;
		row := Float->New[cols];	
		each(i : rows) {
			each(j : cols) {
				row[j] := matrix[i,j];
			};
			row_str := row->ToString();
			dist := EuclideanDistance(row, test);
			results->AddBack(dist);
			"{$row_str}: {$dist}"->PrintLine();
		};

		"--- K-Results ---"->PrintLine();

		results->Sort();
		each(i : k) {
			result := results->Get(i)->Get();
			"{$i}: {$result}"->PrintLine();
		};
	}

	function : EuclideanDistance(a : Float[], b : Float[]) ~ Float {
		if(a->Size() <> b->Size()) {
			return 0.0;
		};

		total := 0.0;
		
		each(i : a) {
			diff := b[i] - a[i];
			total += diff * diff;
		};

		return total->Sqrt();
	}
}